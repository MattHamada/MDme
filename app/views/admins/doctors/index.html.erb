<%= provide(:title, 'Doctors') %>
<div>
  <div class="row">
    <div class="col-md-6"><h2>Doctors</h2></div>
    <div class="col-md-6">Search:<input type="text" id="doctors-search"/></div>
  </div>
  <div id="doctor-index-list" style="margin: 2em">
    <%= render 'admins/shared/user_list' %>
  </div>
</div>

<script type="text/javascript">
  $(document).on('ready page:change page:load', function() {
    //timeout waits 0.5 seconds for more keypresses before ajax call
    var timeout;
    $('#doctors-search').on('keyup', function() {
      if(timeout){
        clearTimeout(timeout);
      }
      timeout = setTimeout(function() {
        var doctor_search = $('#doctors-search').val();
        $.ajax({
          type: "GET",
          url: '<%= admin_doctors_path(@admin)%>',
          data: {
            doctor_search: doctor_search
          },
          success: function(data) {
            $('#doctor-index-list').html(data)
          },
          error: function(error) {
            console.log(error);
          }
        });
      }, 500);
    });
  });
  
</script>